<!DOCTYPE html>
<html>
<head>
<title>beatlounge (C) 2011 The BeatLoungers society</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<style type="text/css">
tr.even { background-color: #ddd; }
.txt { color: #5ef; background: #000;}
.demarc { background: red; }
.on div { background: green; }
td div { border-radius: 5px; width: 20px; height: 20px; }
</style>
</head>
<body>
<header><hgroup><h1>`---\...beatlounge web ui.../---,</h1></hgroup></header>
<article>
<h2>a step-sequencer over 4 measures and spanning 2 octaves</h2>
<form id="notesender" action="POST">
</form>
<script language="javascript">
    $(document).ready( function () {

        var NOTES = [ "C0", "C#0", "D0", "D#0", "E0", "F0", "F#0", "G0", "G#0",
                      "A0", "A#0", "B0", "C1", "C#1", "D1", "D#1", "E1",
                      "F1", "F#1", "G1", "G#1", "A1", "A#1", "B1" ];

        var html = "<table><tr><td class='demarc'>||</td>";
        for (var i = 0; i < 64; i++) {
            if (i % 16 == 0) {
                html += '<td class="demarc">||</td>';
            }
            html += '<td class="txt">' + i + '</td>';
        }
        html += '</tr>'
        for (var i = 0; i < 24; i++) {
            var cls = 'odd';
            if (i % 2 == 0) {
                cls = 'even';
            }
            html += '<tr class="' + cls + '"><td class="txt">' + NOTES[(23-i)] + '</td>';
            for (var j = 0; j < 64; j++) {
                if (j % 16 == 0) {
                    html += '<td class="demarc">||</td>';
                }
                html += "<td class='note-switch'><div><input title='" + j + "-" + (23-i) + "' "
                     + "id='noteon-" + j + "-" + (23-i) + "' type='hidden' value='0'></div></td>";
            }
            html += "</tr>";
        }
        html += '</table>'
        $("#notesender").append(html);
        $(".note-switch").click(function(evt){
            console.log("switched: " + evt)
            var o = $(this);
            var ison = o.hasClass('on');
            var toggle = o.children('div').children('input');
            if (ison) {
                o.removeClass('on');
                //$(toggle).value('1');
                var title = toggle.attr('title');
                $.post('/off-' + title);
            } else {
                o.addClass('on');
                //$(toggle).value('0');
                var title = toggle.attr('title');
                $.post('/on-' + title);
            }
        });
        console.log("completed append");
    });
</script>
</article>
</body>
</html>
